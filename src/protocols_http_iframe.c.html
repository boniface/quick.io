<!DOCTYPE html> <head> <meta charset="UTF-8"> <script>var pendingPoll,publicAddress="{PUBLIC_ADDRESS}",requests=0,instanceId=-1,pendingEvents=[],uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var b=Math.random()*16|0,a=d=="x"?b:(b&3|8);return a.toString(16)});function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+a+"=([^&#]*)"),b=c.exec(location.search);return b==null?"":decodeURIComponent(b[1].replace(/\+/g," "))}function send(a,b){window.parent.postMessage({from:"QuickIO",type:a,instanceId:instanceId,data:b},"*")}function requestDone(){requests--;if(requests==0){requestPoll()}}function sendError(){send("error",null);requestDone()}function poll(d,b){var c=new XMLHttpRequest(),a="/?sid="+uuid+(b?"&connect=true":"");c.onerror=sendError;c.onload=function(){var g,f,e=[];if(c.status!=200){sendError();return}f=this.responseText.split("\n");for(g=0;g<f.length;g++){if(f[g]){e.push(f[g])}}if(e.length>0){send("events",e)}requestDone()};c.open("POST",a,true);c.send(d);requests++}function requestPoll(){if(!pendingPoll){pendingPoll=setTimeout(function(){var a=pendingEvents.join("\n");pendingEvents=[];poll(a);pendingPoll=null},Math.ceil(Math.random()*2000))}}function onPostMessage(a){pendingEvents.push(a.data);requestPoll()}function sendServerUrl(){send("ready",{serverUrl:publicAddress})}function startClient(){if(window.addEventListener){window.addEventListener("message",onPostMessage,false)}else{if(window.attachEvent){window.attachEvent("onmessage",onPostMessage)}}poll("",true);send("ready",null)}function run(){document.removeEventListener("DOMContentLoaded",run,false);window.removeEventListener("load",run,false);instanceId=parseInt(getParameterByName("instanceId"));if(getParameterByName("connectionTest")){sendServerUrl()}else{startClient()}}document.addEventListener("DOMContentLoaded",run,false);window.addEventListener("load",run,false);</script> </head> <body> </body>